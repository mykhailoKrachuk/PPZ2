<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Strona klienta</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="page client-page">
  <header class="topbar">
    <a href="index.html" class="logo">
      <div class="logo-icon">üì¶</div>
      <span>Salfetka</span>
    </a>
    <nav class="topbar-nav">
      <a class="link-btn" href="index.html">Wyszukaj przesy≈Çkƒô</a>
      <a class="link-btn" href="login.html">Wy≈Çoguj siƒô</a>
    </nav>
  </header>

  <main class="client-panel">
    <aside class="filter-card">
      <h2 class="section-title">Filtruj</h2>
      <div class="form-group">
        <label for="filterId">Numer przesy≈Çki</label>
        <input id="filterId" class="input slim" type="text" placeholder="Wpisz numer przesy≈Çki">
      </div>

      <div class="form-group">
        <label for="filterDate">Data nadania</label>
        <input id="filterDate" class="input slim" type="date">
      </div>

      <div class="form-group">
        <label for="filterStatus">Status</label>
        <select id="filterStatus" class="input slim">
          <option value="">Wszystkie statusy</option>
          <option>Utworzona</option>
          <option>W drodze</option>
          <option>Dostarczona</option>
          <option>Wydana klientowi</option>
        </select>
      </div>
    </aside>

    <section class="shipments-card">
      <h2 class="section-title">Lista przesy≈Çek</h2>
      <div id="shipmentList" class="shipments-list"></div>
    </section>

    <div id="detailsOverlay" class="details-overlay hidden" aria-hidden="true">
      <div class="details-card" role="dialog" aria-modal="true" aria-labelledby="detailsHeading">
        <button id="closeDetails" class="close-btn" type="button" aria-label="Zamknij okno">&times;</button>
        <h3 id="detailsHeading">Informacje o przesy≈Çce</h3>
        <p class="details-code" id="detailsCode">Wybierz przesy≈Çkƒô</p>
        <p id="detailsStatus"></p>
        <p id="detailsDate"></p>
        <div id="detailsRoute" class="route-timeline"></div>
      </div>
    </div>
  </main>
</div>

<script>
  // Prosta \"baza danych\" przesy≈Çek z przyk≈Çadowymi trasami
  const shipments = [
    { 
      id:'NPX66UW2GP', 
      status:'Utworzona', 
      date:'2025-10-24',
      route: [
        { status: 'Utworzona', label: 'Utworzona', date: '22-10-2025 10:12', location: 'Warszawa ‚Äì nadanie paczki' }
      ]
    },
    { 
      id:'WX90PL0AA1', 
      status:'W drodze', 
      date:'2025-10-20',
      route: [
        { status: 'Utworzona', label: 'Utworzona', date: '18-10-2025 09:05', location: 'Krak√≥w ‚Äì rejestracja przesy≈Çki' },
        { status: 'Wys≈Çana', label: 'Wys≈Çana z magazynu', date: '19-10-2025 14:30', location: 'Magazyn centralny' },
        { status: 'W drodze', label: 'W drodze', date: '20-10-2025 06:45', location: 'Trasa do paczkomatu' }
      ]
    },
    { 
      id:'JL55MK7CD2', 
      status:'Dostarczona', 
      date:'2025-09-18',
      route: [
        { status: 'Utworzona', label: 'Utworzona', date: '15-09-2025 11:20', location: 'Pozna≈Ñ ‚Äì utworzenie etykiety' },
        { status: 'W drodze', label: 'W drodze', date: '16-09-2025 08:10', location: 'Centrum sortowania' },
        { status: 'Dostarczona', label: 'Dostarczona do paczkomatu', date: '18-09-2025 17:30', location: 'Paczkamat JL-02' }
      ]
    },
    { 
      id:'BT73RT1XZ3', 
      status:'Wydana klientowi', 
      date:'2025-08-04',
      route: [
        { status: 'Utworzona', label: 'Utworzona', date: '01-08-2025 10:00', location: 'Warszawa ‚Äì sklep internetowy' },
        { status: 'W drodze', label: 'W drodze', date: '02-08-2025 13:40', location: 'Kurier w trasie' },
        { status: 'Dostarczona', label: 'Dostarczona do punktu', date: '03-08-2025 09:15', location: 'Punkt odbioru BT-17' },
        { status: 'Wydana klientowi', label: 'Wydana klientowi', date: '04-08-2025 18:02', location: 'Punkt odbioru BT-17' }
      ]
    },
    { 
      id:'QP19ZD8LK4', 
      status:'W drodze', 
      date:'2025-10-18',
      route: [
        { status: 'Utworzona', label: 'Utworzona', date: '16-10-2025 12:48', location: '≈Å√≥d≈∫ ‚Äì nadanie' },
        { status: 'Magazyn', label: 'W magazynie', date: '17-10-2025 07:30', location: 'Magazyn regionalny' },
        { status: 'W drodze', label: 'W drodze do klienta', date: '18-10-2025 08:20', location: 'Trasa do paczkomatu' }
      ]
    }
  ];

  const listEl = document.getElementById('shipmentList');
  const detailsOverlay = document.getElementById('detailsOverlay');
  const closeDetailsBtn = document.getElementById('closeDetails');
  const detailCode = document.getElementById('detailsCode');
  const detailStatus = document.getElementById('detailsStatus');
  const detailDate = document.getElementById('detailsDate');
  const detailRoute = document.getElementById('detailsRoute');

  const filterId = document.getElementById('filterId');
  const filterDate = document.getElementById('filterDate');
  const filterStatus = document.getElementById('filterStatus');

  const filters = {
    id: '',
    date: '',
    status: ''
  };

  function applyFilters(){
    const idValue = filters.id.toLowerCase();
    return shipments.filter(item => {
      const matchesId = !idValue || item.id.toLowerCase().includes(idValue);
      const matchesDate = !filters.date || item.date === filters.date;
      const matchesStatus = !filters.status || item.status === filters.status;
      return matchesId && matchesDate && matchesStatus;
    });
  }

  function getStatusBadgeClass(status) {
    const statusMap = {
      'Utworzona': 'utworzona',
      'W drodze': 'w-drodze',
      'Dostarczona': 'dostarczona',
      'Wydana klientowi': 'wydana-klientowi'
    };
    return statusMap[status] || 'utworzona';
  }

  function renderList(){
    const filtered = applyFilters();
    listEl.innerHTML = '';
    if(!filtered.length){
      const empty = document.createElement('div');
      empty.className = 'empty';
      empty.innerHTML = `
        <div class="empty-icon">üì¶</div>
        <div class="empty-text">Brak przesy≈Çek do wy≈õwietlenia</div>
      `;
      listEl.appendChild(empty);
      return;
    }

    filtered.forEach(item => {
      const btn = document.createElement('button');
      btn.className = 'shipment-row';
      btn.type = 'button';
      btn.innerHTML = `
        <strong>${item.id}</strong>
        <span class="status-badge ${getStatusBadgeClass(item.status)}">${item.status}</span>
        <span>${item.date.split('-').reverse().join('-')}</span>
      `;
      btn.addEventListener('click', () => showDetails(item));
      listEl.appendChild(btn);
    });
  }

  function renderRoute(item){
    if(!item.route || !item.route.length){
      detailRoute.innerHTML = '';
      return;
    }

    const stepsHtml = item.route.map((step, index) => {
      const isLast = index === item.route.length - 1;
      const badgeClass = getStatusBadgeClass(step.status);
      return `
        <div class="route-step ${isLast ? 'route-step--current' : ''}">
          <div class="route-step-marker">
            <span class="route-step-dot"></span>
            ${!isLast ? '<span class="route-step-line"></span>' : ''}
          </div>
          <div class="route-step-content">
            <div class="route-step-title">${step.label}</div>
            <div class="route-step-meta">${step.date}</div>
            <div class="route-step-meta">${step.location}</div>
            <div class="route-step-status">
              <span class="status-badge ${badgeClass}">${step.status}</span>
            </div>
          </div>
        </div>
      `;
    }).join('');

    detailRoute.innerHTML = `
      <h4 class="route-title">Trasa przesy≈Çki</h4>
      ${stepsHtml}
    `;
  }

  function showDetails(item){
    detailCode.textContent = item.id;
    detailStatus.innerHTML = 'Status: <span class="status-badge ' + getStatusBadgeClass(item.status) + '">' + item.status + '</span>';
    detailDate.textContent = 'Data wys≈Çania: ' + item.date.split('-').reverse().join('-');
    renderRoute(item);
    detailsOverlay.classList.remove('hidden');
    detailsOverlay.setAttribute('aria-hidden', 'false');
  }

  function hideDetails(){
    detailsOverlay.classList.add('hidden');
    detailsOverlay.setAttribute('aria-hidden', 'true');
  }

  closeDetailsBtn.addEventListener('click', hideDetails);
  detailsOverlay.addEventListener('click', (e) => {
    if(e.target === detailsOverlay){
      hideDetails();
    }
  });

  function updateFilter(key, value){
    filters[key] = value;
    renderList();
  }

  filterId.addEventListener('input', e => updateFilter('id', e.target.value));
  filterDate.addEventListener('input', e => updateFilter('date', e.target.value));
  filterStatus.addEventListener('change', e => updateFilter('status', e.target.value));

  renderList();
</script>
</body>
</html>

